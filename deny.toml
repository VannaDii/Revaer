# cargo-deny configuration aligned with the Phase One licensing policy.

[advisories]
ignore = ["RUSTSEC-2025-0111"] # tokio-tar via testcontainers; monitor upstream (review by 2026-03-31)

[licenses]
allow = [
    "Apache-2.0",
    "BSD-2-Clause",
    "BSD-3-Clause",
    "MIT-0",
    "MIT",
    "Unlicense",
    "Unicode-3.0",
    "Zlib",
    "ISC",
    "CDLA-Permissive-2.0",
]
confidence-threshold = 0.8
exceptions = []

[licenses.private]
ignore = false
registries = []

[bans]
multiple-versions = "deny"
wildcards = "allow"

[[bans.skip]]
crate = "getrandom@0.2.16"
reason = "Legacy rand 0.8 stack from password hashing dependencies."

[[bans.skip]]
crate = "getrandom@0.3.3"
reason = "Hashbrown/ahash stack pulled by jsonschema and rand 0.9 users."

[[bans.skip]]
crate = "hashbrown@0.15.5"
reason = "sqlx 0.8 still depends on hashbrown 0.15.x for hashlink support."

[[bans.skip]]
crate = "hashbrown@0.16.0"
reason = "Latest indexmap release chain (reqwest, axum) requires 0.16.x."

[[bans.skip]]
crate = "rand@0.8.5"
reason = "sqlx 0.8 transitively depends on rand 0.8.x."

[[bans.skip]]
crate = "rand@0.9.2"
reason = "Latest dependencies (reqwest/testcontainers) require rand 0.9.x."

[[bans.skip]]
crate = "rand_chacha@0.3.1"
reason = "sqlx 0.8 transitively depends on rand 0.8.x stack."

[[bans.skip]]
crate = "rand_chacha@0.9.0"
reason = "rand 0.9.x stack required by reqwest/testcontainers."

[[bans.skip]]
crate = "rand_core@0.6.4"
reason = "argon2/password-hash use rand_core 0.6.x."

[[bans.skip]]
crate = "rand_core@0.9.3"
reason = "rand 0.9.x stack required by reqwest/testcontainers."

[[bans.skip]]
crate = "thiserror@1.0.69"
reason = "Prometheus/protobuf pin the 1.x line."

[[bans.skip]]
crate = "thiserror@2.0.17"
reason = "Workspace crates use the current 2.x line."

[[bans.skip]]
crate = "thiserror-impl@1.0.69"
reason = "Matches thiserror 1.x pinned by prometheus/protobuf."

[[bans.skip]]
crate = "thiserror-impl@2.0.17"
reason = "Matches thiserror 2.x used by workspace crates."

[[bans.skip]]
crate = "wasi@0.11.1+wasi-snapshot-preview1"
reason = "Legacy rand 0.8 stack depends on the snapshot preview runtime."

[[bans.skip]]
crate = "wasi@0.14.7+wasi-0.2.4"
reason = "rand 0.9 stack requires the new WASI 0.2 bindings."

[[bans.skip]]
crate = "webpki-roots@*"
reason = "Both sqlx/ureq (0.26.x) and hyper-rustls/reqwest (1.x) are required."

[[bans.skip]]
crate = "foldhash@0.1.5"
reason = "hashbrown still pins the 0.1.x series alongside libtorrent's cxx dependency."

[[bans.skip]]
crate = "foldhash@0.2.0"
reason = "cxx 1.0 pulls the 0.2.x series; allow the dual version while libtorrent is linked."

[[bans.skip]]
crate = "windows-sys@*"
reason = "Tokio, sqlx, and rustls require multiple versions across their supported Windows targets."

[[bans.skip]]
crate = "windows-targets@*"
reason = "Matches windows-sys releases for individual target triples."

[[bans.skip]]
crate = "windows_aarch64_gnullvm@*"
reason = "Target-specific windows bindings; duplicates mirror windows-sys versions."

[[bans.skip]]
crate = "windows_aarch64_msvc@*"
reason = "Target-specific windows bindings; duplicates mirror windows-sys versions."

[[bans.skip]]
crate = "windows_i686_gnu@*"
reason = "Target-specific windows bindings; duplicates mirror windows-sys versions."

[[bans.skip]]
crate = "windows_i686_gnullvm@*"
reason = "Target-specific windows bindings; duplicates mirror windows-sys versions."

[[bans.skip]]
crate = "windows_i686_msvc@*"
reason = "Target-specific windows bindings; duplicates mirror windows-sys versions."

[[bans.skip]]
crate = "windows_x86_64_gnu@*"
reason = "Target-specific windows bindings; duplicates mirror windows-sys versions."

[[bans.skip]]
crate = "windows_x86_64_gnullvm@*"
reason = "Target-specific windows bindings; duplicates mirror windows-sys versions."

[[bans.skip]]
crate = "windows_x86_64_msvc@*"
reason = "Target-specific windows bindings; duplicates mirror windows-sys versions."

[sources]
unknown-registry = "deny"
unknown-git = "deny"
allow-registry = ["https://github.com/rust-lang/crates.io-index"]
allow-git = []
