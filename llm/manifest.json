{
  "version": "0.1.0",
  "generated": "2025-12-12T22:28:17.992333101+00:00",
  "entries": [
    {
      "id": "adr/001-configuration-revisioning",
      "title": "001 – Global Configuration Revisioning",
      "summary": "Status: Proposed Date: 2025-02-23",
      "tags": [
        "consequences",
        "context",
        "decision",
        "follow-up"
      ],
      "href": "/adr/001-configuration-revisioning/"
    },
    {
      "id": "adr/002-setup-token-lifecycle",
      "title": "002 – Setup Token Lifecycle & Secrets Bootstrap",
      "summary": "Status: Proposed Date: 2025-02-23",
      "tags": [
        "consequences",
        "context",
        "decision",
        "follow-up"
      ],
      "href": "/adr/002-setup-token-lifecycle/"
    },
    {
      "id": "adr/003-libtorrent-session-runner",
      "title": "003 – Libtorrent Session Runner Architecture",
      "summary": "Status: Accepted Date: 2025-10-16",
      "tags": [
        "consequences",
        "context",
        "decision",
        "follow-up"
      ],
      "href": "/adr/003-libtorrent-session-runner/"
    },
    {
      "id": "adr/004-phase-one-delivery",
      "title": "004 – Phase One Delivery Track",
      "summary": "Status: Accepted Date: 2025-10-17",
      "tags": [
        "dependency-rationale",
        "design-notes",
        "motivation",
        "observability-updates",
        "outcome",
        "risk-rollback-plan",
        "test-coverage-summary"
      ],
      "href": "/adr/004-phase-one-delivery/"
    },
    {
      "id": "adr/005-fsops-pipeline",
      "title": "005 – FsOps Pipeline Hardening",
      "summary": "Status: Accepted Date: 2025-10-17",
      "tags": [
        "consequences",
        "context",
        "decision",
        "verification"
      ],
      "href": "/adr/005-fsops-pipeline/"
    },
    {
      "id": "adr/006-api-cli-contract",
      "title": "006 – Unified API & CLI Contract",
      "summary": "Status: Accepted Date: 2025-10-17",
      "tags": [
        "consequences",
        "context",
        "decision",
        "verification"
      ],
      "href": "/adr/006-api-cli-contract/"
    },
    {
      "id": "adr/007-security-posture",
      "title": "007 – API Key Security & Rate Limiting",
      "summary": "Status: Accepted Date: 2025-10-17",
      "tags": [
        "consequences",
        "context",
        "decision",
        "verification"
      ],
      "href": "/adr/007-security-posture/"
    },
    {
      "id": "adr/008-phase-one-remaining-task",
      "title": "008 – Phase One Remaining Delivery (Task Record)",
      "summary": "Status: In Progress Date: 2025-10-17",
      "tags": [
        "dependency-rationale",
        "design-notes",
        "motivation",
        "observability-updates",
        "risk-rollback",
        "test-coverage-summary"
      ],
      "href": "/adr/008-phase-one-remaining-task/"
    },
    {
      "id": "adr/009-fsops-permission-hardening",
      "title": "009 – FsOps Permission Hardening",
      "summary": "Status: Accepted Date: 2025-10-18",
      "tags": [
        "dependency-rationale",
        "design-notes",
        "motivation",
        "observability-updates",
        "risk-rollback-plan",
        "test-coverage-summary"
      ],
      "href": "/adr/009-fsops-permission-hardening/"
    },
    {
      "id": "adr/010-agent-compliance-sweep",
      "title": "Agent Compliance Sweep",
      "summary": "Status: Accepted Date: 2025-11-01 Context: AGENT.md requires just recipes to enforce warnings-as-errors and mandates a global CLI --output json|table selector; the repository had drifted (recipes invoked cargo without the configured rustflags and the CLI only exposed per-command --format switches). Motivation: restore explicit compliance so local and CI workflows produce identical results and the documented CLI surface remains accurate for operators and scripts. Decision: Design notes: updated just lint/check/test/udeps to follow the prescribed commands, wiring build.rustflags=[\"-Dwarnings\"] through just, probing cargo-udeps with the stable toolchain first, and automatically retrying with nightly when the tool still requires -Z binary-dep-depinfo (surfacing a single log",
      "tags": [],
      "href": "/adr/010-agent-compliance-sweep/"
    },
    {
      "id": "adr/011-coverage-hardening-phase-two",
      "title": "Coverage Hardening Phase Two",
      "summary": "Status: Accepted Date: 2025-11-02 Context: AGENT.md now forbids suppressing coverage with cargo llvm-cov flags and requires a ≥80 % threshold across all libraries. The workspace still relied on just cov exclusions and lacked comprehensive tests in revaer-doc-indexer and revaer-cli, blocking true compliance. Motivation: remove the tooling loophole, add high-value tests, and document the remaining work needed to finish the coverage push. Decision: Design notes: Updated the Justfile so just cov executes cargo llvm-cov --workspace --fail-under-lines 80, matching AGENT.md without suppression flags. Added an extensive unit suite for revaer-doc-indexer that exercises markdown parsing, fallback summaries, tag normalisation, schema validation, and manifest",
      "tags": [],
      "href": "/adr/011-coverage-hardening-phase-two/"
    },
    {
      "id": "adr/012-agent-compliance-refresh",
      "title": "Agent Compliance Refresh",
      "summary": "Status: Accepted Date: 2025-11-02 Context: AGENT.md forbids unsafe code across the workspace, yet the configuration integration tests were still using an unsafe block when populating DOCKER_HOST. The task ensures ongoing conformance with the agent policy and documents the work so future checks remain traceable. Decision: Deleted the redundant host-configuration helper so the tests defer to testcontainers' built-in socket discovery instead of mutating the process environment. Alternatives considered: leave the unsafe block in place (rejected because it violates the prime directive), gate the tests behind a feature flag (rejected—dead test code would violate the zero-dead-code rule). Consequences: Positive outcomes: the test",
      "tags": [],
      "href": "/adr/012-agent-compliance-refresh/"
    },
    {
      "id": "adr/013-runtime-persistence",
      "title": "013 – Runtime Persistence for Torrents and FsOps Jobs",
      "summary": "Status: Accepted Date: 2025-10-27",
      "tags": [
        "dependency-rationale",
        "design-notes",
        "motivation",
        "observability-updates",
        "risk-rollback",
        "test-coverage-summary"
      ],
      "href": "/adr/013-runtime-persistence/"
    },
    {
      "id": "adr/014-data-access-layer",
      "title": "014 – Centralized Data Access Layer",
      "summary": "Status: Accepted Date: 2025-02-14",
      "tags": [
        "consequences",
        "context",
        "decision",
        "follow-up"
      ],
      "href": "/adr/014-data-access-layer/"
    },
    {
      "id": "adr/015-agent-compliance-hardening",
      "title": "015: Agent Compliance Hardening",
      "summary": "Status: Superseded by 016 Date: 2025-11-26 Context: AGENT.md now forbids unsafe code and bans lint suppressions for precision loss, missing docs/errors, and dormant code; several crates still relied on those allowances. The libtorrent adapter depended on a C++ bridge and build.rs, introducing unsafe blocks that violated the updated directives. API/config paths carried #[allow] gates to bypass documentation and float-cast lints, masking real enforcement. Decision: Removed the libtorrent C++ bridge (build script and FFI sources) and now run the adapter solely on the safe StubSession, keeping the crate #![forbid(unsafe_code)]. Swapped float casts in rate limiting/formatting paths for integer-based accounting and From",
      "tags": [],
      "href": "/adr/015-agent-compliance-hardening/"
    },
    {
      "id": "adr/016-libtorrent-restoration",
      "title": "016: Libtorrent Restoration",
      "summary": "Status: Accepted Date: 2025-11-26 Context: AGENT rules now permit tightly scoped #[allow(...)] inside unavoidable FFI. Removing the C++ bridge dropped real torrent handling, violating product requirements. We need a known-compatible libtorrent integration with deterministic build wiring and coverage across the feature-gated path. Decision: Restored the native libtorrent C++ bridge (cxx), FFI bindings, and NativeSession so the libtorrent feature drives the actual engine path while stubs remain for tests/offline builds. Kept lint posture strict (#![deny(unsafe_code)), confining #[allow(unsafe_code)] to the FFI module only. Build script now enforces a minimum libtorrent version (>= 2.0.10) via pkg-config, supports an explicit LIBTORRENT_BUNDLE_DIR (include/lib) for vendored",
      "tags": [],
      "href": "/adr/016-libtorrent-restoration/"
    },
    {
      "id": "adr/017-sqlx-named-bind",
      "title": "Avoid `sqlx-named-bind`",
      "summary": "Status: Accepted Date: 2025-11-28",
      "tags": [
        "consequences",
        "context",
        "decision",
        "follow-up"
      ],
      "href": "/adr/017-sqlx-named-bind/"
    },
    {
      "id": "adr/018-retire-testcontainers",
      "title": "Retire testcontainers",
      "summary": "Status: Accepted Date: 2025-12-06 Context: cargo audit flagged rustls-pemfile (RUSTSEC-2025-0134) as unmaintained, pulled via testcontainers → bollard. AGENT.md forbids local patches and prefers minimal dependencies; maintaining a forked TLS stack would violate both. Our Docker-backed integration tests (Postgres + libtorrent) depended on testcontainers; removing the crate requires alternate coverage. Decision: Remove testcontainers and associated patches from the workspace; delete Docker-backed integration tests and replace them with lightweight unit coverage. Keep filesystem orchestration tests in place using in-process fakes instead of containerized services. Drop the .secignore/deny.toml allowances tied to the testcontainers advisory; rely solely on crates.io sources. Alternatives considered: Upgrade to",
      "tags": [],
      "href": "/adr/018-retire-testcontainers/"
    },
    {
      "id": "adr/019-advisory-rustsec-2024-0370",
      "title": "Advisory RUSTSEC-2024-0370 Temporary Ignore",
      "summary": "Status: Accepted Date: 2025-02-21 Context: The workspace depends on yew for the UI crate, which transitively pulls proc-macro-error, currently flagged by advisory RUSTSEC-2024-0370 (unmaintained). The affected package is used only via the Yew compile-time macro stack; there is no direct runtime exposure, and no maintained alternative in the current Yew release line. cargo-deny and .secignore both require an explicit justification and remediation plan for any ignore. Decision: Keep the advisory ignored in .secignore and deny.toml while remaining on the current Yew release. Monitor Yew’s releases and remove the ignore as soon as Yew drops the proc-macro-error dependency or provides a",
      "tags": [],
      "href": "/adr/019-advisory-rustsec-2024-0370/"
    },
    {
      "id": "adr/020-torrent-engine-precursors",
      "title": "Torrent engine precursor hardening",
      "summary": "Status: Accepted Date: 2025-12-10 Context: Torrent work in TORRENT_GAPS.md needs shared scaffolding before adding tracker/NAT/limit features. Validation and persistence had drifted across API/runtime/DB; per-field SQL updates risked skew and missing guard rails. The FFI surface for libtorrent was a flat struct that would become unmanageable as new knobs land. Native tests were slow to write without a harness to spin a session and apply configs. Decision: Introduced engine_profile module to normalise/validate profile patches, emit effective views with guard-rail warnings, and clamp before storage/runtime use. Replaced per-field SQL with a unified update_engine_profile stored procedure and EngineProfileUpdate data shape to keep DB/API",
      "tags": [],
      "href": "/adr/020-torrent-engine-precursors/"
    },
    {
      "id": "adr/021-torrent-precursor-enforcement",
      "title": "Torrent precursor enforcement",
      "summary": "Status: Accepted Date: 2025-12-12 Context: TORRENT_GAPS precursors called for unified engine profile persistence/validation before expanding tracker/NAT features. Legacy per-field stored procedures risked drifting from the shared validator and API/runtime expectations. Runtime → FFI mapping lived inline, making it harder to clamp unsafe values or extend with new options; native tests lacked a reusable harness. Decision: Retired the per-field engine profile update functions/procedures in favour of the single update_engine_profile entry point (migration 0005_engine_profile_cleanup), keeping DB/API validation aligned. Introduced EngineOptionsPlan::from_runtime_config to clamp/disable invalid runtime values before crossing the FFI boundary and surface guard-rail warnings in the native session. Added a reusable NativeSessionHarness",
      "tags": [],
      "href": "/adr/021-torrent-precursor-enforcement/"
    },
    {
      "id": "adr/022-torrent-settings-parity",
      "title": "Torrent settings parity and observability",
      "summary": "Status: Accepted Date: 2025-12-12 Context: TORRENT_GAPS precursor calls for API/runtime parity and observability of the knobs we already support. Torrent details previously lacked a single place to inspect applied settings (rate caps, selection rules, tags/trackers) and metadata drifted after rate/selection updates. Engine profile parity (stored vs effective) is already exposed via the config snapshot, but per-torrent settings needed an equivalent surface. Decision: Expose a TorrentSettingsView on torrent detail responses covering download_dir/sequential status from the inspector plus tags/trackers/rate caps and the latest selection rules captured in API state. Record selection rules and rate limit updates in TorrentMetadata on creation and after",
      "tags": [],
      "href": "/adr/022-torrent-settings-parity/"
    },
    {
      "id": "adr/index",
      "title": "Architecture Decision Records",
      "summary": "ADR documents capture the rationale behind significant technical decisions.",
      "tags": [
        "catalogue",
        "suggested-workflow"
      ],
      "href": "/adr/index/"
    },
    {
      "id": "adr/template",
      "title": "{ADR Title}",
      "summary": "Status: {Proposed|Accepted|Superseded} Date: {YYYY-MM-DD} Context: What problem are we solving? What constraints or forces shape the decision? Decision: Summary of the choice made. Alternatives considered. Consequences: Positive outcomes. Risks or trade-offs. Follow-up: Implementation tasks. Review checkpoints.",
      "tags": [],
      "href": "/adr/template/"
    },
    {
      "id": "api/guides/bootstrap",
      "title": "Bootstrap & Workflow Lifecycle",
      "summary": "This guide explains how the Revaer application stitches configuration, orchestration, and observability components together once the binary starts.",
      "tags": [
        "error-handling",
        "operational-signals",
        "runtime-updates",
        "startup-flow"
      ],
      "href": "/api/guides/bootstrap/"
    },
    {
      "id": "api/guides/cli",
      "title": "CLI Usage Guide",
      "summary": "The revaer CLI provides parity with the public API while honouring the same authentication, pagination, and SSE semantics.",
      "tags": [
        "commands",
        "exit-codes",
        "global-flags",
        "telemetry"
      ],
      "href": "/api/guides/cli/"
    },
    {
      "id": "api/guides/operations",
      "title": "Operational Setup & Security",
      "summary": "Issue keys via settings changesets (SettingsChangeset::api_keys) including:\\n+ json\\n+ {\\n+ \\\"op\\\": \\\"upsert\\\",\\n+ \\\"key_id\\\": \\\"automation\\\",\\n+ \\\"label\\\": \\\"CI\\\",\\n+ \\\"secret\\\": \\\"<generated>\\\",\\n+ \\\"rate_limit\\\": { \\\"burst\\\": 60, \\\"per_seconds\\\": 60 }\\n+ }\\n+ \\n+2. Secrets are hashed at rest; rotate keys by supplying a new secret value.\\n+3. Disable keys with { \\\"op\\\": \\\"upsert\\\", \\\"key_id\\\": \\\"automation\\\", \\\"enabled\\\": false }.\\n+4. Remove keys with { \\\"op\\\": \\\"delete\\\", \\\"key_id\\\": \\\"automation\\\" }.\\n+\\n+Invalid rate-limit payloads (missing fields, zero burst) are rejected during configuration apply with RFC9457 errors.\\n+\\n+## Rate Limiting\\n+\\n+- Token bucket with parameters burst (maximum outstanding requests) and per_seconds (replenish interval).\\n+- Requests exceeding limits receive 429 Problem+JSON responses; CLI maps these to exit code",
      "tags": [
        "api-key-lifecycle"
      ],
      "href": "/api/guides/operations/"
    },
    {
      "id": "api/guides/telemetry",
      "title": "Telemetry & Metrics Reference",
      "summary": "Revaer exposes structured telemetry via Prometheus metrics, tracing spans, CLI events, and health endpoints.",
      "tags": [
        "cli-telemetry",
        "health-endpoints",
        "prometheus-metrics",
        "runbook-validation",
        "tracing"
      ],
      "href": "/api/guides/telemetry/"
    },
    {
      "id": "api/index",
      "title": "API Documentation",
      "summary": "This directory hosts HTTP API specifications, generated OpenAPI documents, and usage guides for the Revaer control plane.",
      "tags": [
        "contents",
        "current-coverage",
        "next-steps"
      ],
      "href": "/api/index/"
    },
    {
      "id": "api/openapi",
      "title": "OpenAPI Reference",
      "summary": "Canonical machine-readable description of the Revaer control plane surface.",
      "tags": [],
      "href": "/api/openapi/"
    },
    {
      "id": "index",
      "title": "Revaer",
      "summary": "Centralized torrent orchestration with hot-reloadable configuration, consistent CLI/API surfaces, and observability-first defaults.",
      "tags": [
        "contributing-updates",
        "llm-manifests",
        "what-youll-find-here"
      ],
      "href": "/index/"
    },
    {
      "id": "phase-one-remaining-spec",
      "title": "Phase One Remaining Engineering Specification",
      "summary": "Deliver a production-ready public interface (HTTP API, SSE, CLI) for torrent orchestration. Ship FsOps-backed artefacts through API, CLI, telemetry, and documentation with demonstrable reliability. Produce release artefacts (containers, binaries, documentation) that satisfy existing security, observability, and quality gates.",
      "tags": [
        "acceptance-criteria",
        "cross-cutting-deliverables",
        "detailed-work-breakdown",
        "objectives",
        "scope-overview",
        "security-observability-requirements-cross-cutting",
        "sequencing-suggested"
      ],
      "href": "/phase-one-remaining-spec/"
    },
    {
      "id": "phase-one-roadmap",
      "title": "Phase One Roadmap",
      "summary": "_Last updated: 2025-11-27_ This document captures the current delta between the Phase One objective and the existing codebase. It should be kept in sync as work progresses across the eight workstreams.",
      "tags": [
        "next-steps-tracking",
        "remaining-scope-specification",
        "snapshot"
      ],
      "href": "/phase-one-roadmap/"
    },
    {
      "id": "platform/api",
      "title": "HTTP API",
      "summary": "REST + SSE surface exposed by `revaer-api`. The OpenAPI document at `/docs/openapi.json` is generated by `just api-export`.",
      "tags": [
        "authentication",
        "endpoint-inventory"
      ],
      "href": "/platform/api/"
    },
    {
      "id": "platform/cli",
      "title": "CLI Reference",
      "summary": "`revaer-cli` provides parity with the API for setup, configuration management, torrent lifecycle, and observability.",
      "tags": [
        "configuration-maintenance",
        "event-streaming",
        "global-flags-environment",
        "setup-flow",
        "torrent-lifecycle"
      ],
      "href": "/platform/cli/"
    },
    {
      "id": "platform/configuration",
      "title": "Configuration Surface",
      "summary": "Canonical reference for the PostgreSQL-backed settings documents that drive Revaer’s runtime behaviour.",
      "tags": [
        "change-workflows",
        "snapshot-components",
        "telemetry-toggle"
      ],
      "href": "/platform/configuration/"
    },
    {
      "id": "platform/native-tests",
      "title": "Native Libtorrent Integration Tests",
      "summary": "These tests are opt-in (gated by REVAER_NATIVE_IT) to keep the default matrix deterministic; include them explicitly in feature-matrix runs. To run the feature-gated native libtorrent integration suite locally: export DOCKER_HOST=${DOCKER_HOST:-unix:///Users/vanna/.colima/default/docker.sock} export REVAER_NATIVE_IT=1 just ci cargo test -p revaer-torrent-libt --all-features CI note: add a matrix job that sets REVAER_NATIVE_IT=1 and points DOCKER_HOST at the runner’s daemon to ensure the native path stays covered.",
      "tags": [],
      "href": "/platform/native-tests/"
    },
    {
      "id": "platform/torrent-flows",
      "title": "Torrent Flows",
      "summary": "Operational views for the torrent lifecycle and the torrent authoring path. These diagrams are reference-only; wire changes must follow the stored-procedure, clamp-before-apply, and observability guardrails in AGENT.md.",
      "tags": [
        "admission-runtime-fsops",
        "torrent-creation-authoring-flow"
      ],
      "href": "/platform/torrent-flows/"
    },
    {
      "id": "release-checklist",
      "title": "Phase One Release Checklist",
      "summary": "**Branch Hygiene** Ensure main is green (CI pipeline complete). Review outstanding ADRs and docs for freshness. **Build & Test** just ci just build-release just api-export **Artefact Verification** Binary: target/release/revaer-app Checksum: sha256sum target/release/revaer-app OpenAPI: docs/api/openapi.json Docker image: just docker-build && just docker-scan **Runbook Execution** Follow docs/runbook.md Archive CLI telemetry, /metrics, /health/full snapshots. **Documentation Refresh** Verify ADRs 005–007 reflect current design. Update user guides (docs/api/guides/*.md) with any behavioural changes. **Tag & Publish** Create annotated tag: git tag -a vX.Y.Z -m \"Phase One release\" Push tag: git push origin vX.Y.Z Attach artefacts generated by the build-release workflow. **Post-Release Monitoring** Watch rate-limit and guard-rail",
      "tags": [],
      "href": "/release-checklist/"
    },
    {
      "id": "runbook",
      "title": "Phase One Runbook",
      "summary": "This runbook exercises the end-to-end control plane, validating FsOps, telemetry, and guard rails.",
      "tags": [
        "prerequisites",
        "scenario",
        "verification-artifacts"
      ],
      "href": "/runbook/"
    },
    {
      "id": "ui/flows",
      "title": "Web UI Flows & Diagrams",
      "summary": "Visual references for the Phase 1 UX: navigation, component wiring, SSE handling, and torrent lifecycle. Use these diagrams when extending the UI or adding tests.",
      "tags": [
        "component-graph",
        "interaction-notes",
        "navigation-flow",
        "sse-event-flow",
        "torrent-lifecycle-ui-perspective"
      ],
      "href": "/ui/flows/"
    },
    {
      "id": "ui/index",
      "title": "Web UI - Phase 1",
      "summary": "Rust/Yew implementation plan for the Phase 1 torrent-only UI described in REVAER_PHASE1_WEBUX_SPEC.md. The goal is a responsive, touch-friendly surface that stays usable on 360px phones through 4K desktops while handling 50k+ torrents. **Pages:** Dashboard, Torrents (list + detail), Search (shared list), Jobs/Post-processing, Settings, Logs. Indexers/Library stay hidden until Phase 2. **Modes:** Simple (default, trimmed controls) and Advanced (all filters, columns, bulk actions). Persisted in local storage without reload. **Transport:** REST for initial payloads; SSE for torrents, transfers, queue, jobs, and VPN state with backoff and jitter handling.",
      "tags": [
        "accessibility-interaction",
        "layout-breakpoints",
        "localization",
        "performance-resilience",
        "running-the-ui",
        "theming-tokens"
      ],
      "href": "/ui/index/"
    }
  ]
}